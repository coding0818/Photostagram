<!DOCTYPE html>
<!--/*
날짜 : 2023/03/31
이름 : 조주영
내용 : 사진 화면
*/-->
<html xmlns:th="http://www.thymleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/myLayout}">
<th:block layout:fragment="main">
    <div id="myActivity">
        <div>
            <a th:href="@{/my/interaction/posts}">게시물</a>
            <a href="#">릴스</a>
        </div>
        <div>
            <div class="activityTop">
                <h1 class="mySortTitle">최신순</h1>
                <a class="mySort">정렬 및 필터</a>
                <a class="mySortSelect">선택</a>
            </div>
            <div class="activityContents">
                <th:block th:each="m:${sortMap}">
                    <a th:href="@{/board/post (no=${m.value.no})}">
                    <th:block th:if="${#strings.endsWith(m.value.firstThumb, '.mp4')} == true">
                        <video th:src="|@{/}thumb/${m.value.firstThumb}"></video>
                    </th:block>
                    <th:block th:unless="${#strings.endsWith(m.value.firstThumb, '.mp4')} == true">
                        <img th:src="|@{/}thumb/${m.value.firstThumb}">
                    </th:block>
                        <input type="checkbox" th:id="${m.value.firstThumb}" th:data-value="${m.value.no}">
                        <label th:for="${m.value.firstThumb}"></label>
                    </a>
                </th:block>
            </div>
        </div>
    </div>
</th:block>
</html>
<script>
    $('.mySortSelect').click(function(){
        let checkArray = [];
        let length = $('input:checked').length;
        //console.log ($('input:checked').length);

        $("input[type=checkbox]:checked").each(function(){
            let no = $(this).attr("data-value");
            checkArray.push(no);
        });

        console.log(checkArray);

        $.ajax({
            url: "/Photostagram/my/delete",
            type: "POST",
            traditional: true,
            data: { checkArray:checkArray, type:"photo" },
            success: function(data){
                console.log("success");
                console.log(data.result);
                $("input[type=checkbox]:checked").hide();
                alert('정상적으로 삭제되었습니다.');
            }
        });
    });
</script>